document.addEventListener('DOMContentLoaded',()=>{function getStorageItem(key){try{return localStorage.getItem(key);}catch(e){return null;}}function setStorageItem(key,value){try{localStorage.setItem(key,value);}catch(e){console.warn('localStorage is not available');}}const userLang = navigator.language || navigator.userLanguage;const isPortuguese = userLang.startsWith('pt');const isPtPage = window.location.pathname.includes('index-pt.html');const savedLang = getStorageItem('preferredLanguage');const hasRedirected = sessionStorage.getItem('hasRedirected');const isManualSwitch = sessionStorage.getItem('manualSwitch');if(!hasRedirected && !isManualSwitch){if(savedLang){if(savedLang === 'pt' && !isPtPage){sessionStorage.setItem('hasRedirected','true');window.location.href = 'index-pt.html';return;}else if(savedLang === 'en' && isPtPage){sessionStorage.setItem('hasRedirected','true');window.location.href = 'index.html';return;}}else{if(!isPtPage && isPortuguese){sessionStorage.setItem('hasRedirected','true');window.location.href = 'index-pt.html';return;}}}sessionStorage.removeItem('hasRedirected');sessionStorage.removeItem('manualSwitch');const langSwitch = document.querySelector('.lang-switch');if(langSwitch){langSwitch.addEventListener('click',(e)=>{e.preventDefault();const targetUrl = langSwitch.getAttribute('href');if(targetUrl.includes('index-pt.html')){setStorageItem('preferredLanguage','pt');}else{setStorageItem('preferredLanguage','en');}sessionStorage.setItem('hasRedirected','true');sessionStorage.setItem('manualSwitch','true');window.location.href = targetUrl;});}const hamburger = document.querySelector('.hamburger');const navLinks = document.querySelector('.nav-links');const navLinkItems = document.querySelectorAll('.nav-links a');if(hamburger){hamburger.addEventListener('click',()=>{navLinks.classList.toggle('nav-active');hamburger.classList.toggle('toggle');});}navLinkItems.forEach(link =>{link.addEventListener('click',()=>{if(navLinks.classList.contains('nav-active')){navLinks.classList.remove('nav-active');hamburger.classList.remove('toggle');}});});document.querySelectorAll('a[href^="#"]').forEach(anchor =>{anchor.addEventListener('click',function(e){e.preventDefault();const target = document.querySelector(this.getAttribute('href'));if(target){target.scrollIntoView({behavior:'smooth'});}});});const observerOptions ={root:null,rootMargin:'0px',threshold:0.1};const observer = new IntersectionObserver((entries,observer)=>{entries.forEach(entry =>{if(entry.isIntersecting){entry.target.classList.add('visible');observer.unobserve(entry.target);}});},observerOptions);document.querySelectorAll('.fade-in-on-scroll').forEach(el =>{observer.observe(el);});function debounce(func,wait){let timeout;return function executedFunction(...args){const later =()=>{clearTimeout(timeout);func(...args);};clearTimeout(timeout);timeout = setTimeout(later,wait);};}const navbar = document.querySelector('.navbar');const handleNavbarScroll =()=>{if(window.scrollY > 50){navbar.style.backgroundColor = 'rgba(15,23,42,0.95)';navbar.style.boxShadow = '0 4px 20px rgba(0,0,0,0.1)';}else{navbar.style.backgroundColor = 'rgba(15,23,42,0.9)';navbar.style.boxShadow = 'none';}};window.addEventListener('scroll',debounce(handleNavbarScroll,10),{passive:true});});